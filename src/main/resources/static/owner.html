<!DOCTYPE html>
<html>
<head>
  <title>Order System - Owner</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.1/sockjs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
  <script type="text/javascript">
    var stompClient = null;

    function connect() {
      var socket = new SockJS('/ws');
      stompClient = Stomp.over(socket);
      stompClient.connect({}, function (frame) {
        console.log('Connected: ' + frame);
        stompClient.subscribe('/topic/orders', function (messageOutput) {
          showOrder(JSON.parse(messageOutput.body));
        });
      });
    }

    function approveOrder(orderId) {
      stompClient.send("/app/order/status", {}, JSON.stringify({
        'orderId': orderId,
        'status': 'APPROVED'
      }));
    }

    function cancelOrder(orderId) {
      stompClient.send("/app/order/status", {}, JSON.stringify({
        'orderId': orderId,
        'status': 'CANCELLED'
      }));
    }

    function showOrder(order) {
      var orderElement = document.getElementById('orderDetails');
      orderElement.innerHTML = 'Order from ' + order.customerName + ': ' + order.orderDetails;
      var actions = document.getElementById('actions');
      actions.innerHTML = `
                <button onclick="approveOrder('${order.orderId}')">Approve</button>
                <button onclick="cancelOrder('${order.orderId}')">Cancel</button>
            `;
    }

    window.onload = function() {
      connect();
    };
  </script>
</head>
<body>
<h1>Order System - Owner</h1>
<div id="orderDetails">No new orders</div>
<div id="actions"></div>
</body>
</html>
